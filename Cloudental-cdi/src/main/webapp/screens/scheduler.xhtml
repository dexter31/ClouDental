<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:h="http://java.sun.com/jsf/html" 
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:cde="http://cloudental.gr"
      xmlns:ui="http://java.sun.com/jsf/facelets">

					<p:schedule id="scheduler" value="#{office.scheduleControler.model}" editable="true" 
									widgetVar="visitSchedule" styleClass="scheduler" aspectRatio="1.9"
									firstHour="8" slotMinutes="5">
						<p:ajax event="dateSelect" listener="#{office.scheduleControler.onDateSelect}" update="eventDetails" oncomplete="createDialog.show()" />
						<p:ajax event="eventSelect" listener="#{office.scheduleControler.onVisitSelect}" update="eventDetails" oncomplete="modifyDialog.show()" />
					</p:schedule>
				 
					<p:dialog widgetVar="createDialog" header="Event Details">
						<h:panelGrid id="eventDetails" columns="2">
							<h:outputLabel for="title" value="Title:" />
							<h:inputText id="title" value="#{office.scheduleControler.event.title}" />
							<h:outputLabel for="from" value="From:" />
							<p:calendar id="from" value="#{office.scheduleControler.event.startDate}" pattern="MM/dd/yyyy HH:mm" />							
							<h:outputLabel for="to" value="To:" />
						    <p:calendar id="to" value="#{office.scheduleControler.event.endDate}" pattern="MM/dd/yyyy HH:mm" />
						    <h:outputLabel for="patient" value="Patient:" />
						    <p:autoComplete id="patient" value="#{office.scheduleControler.event.autocompletePatient}"
								completeMethod="#{office.patientManagment.completePatient}"
								var="p" itemLabel="#{p.name} #{p.surname}" itemValue="#{p}"
								converter="patientConverter" forceSelection="true">
								<p:column>
									<h:outputText value="#{p.id}"/>
								</p:column>
		
								<p:column>  
			                    		#{p.name} - #{p.surname}  
			                	</p:column>
							</p:autoComplete>
							
														
						    <h:outputLabel for="allDay" value="All Day:" />
							<h:selectBooleanCheckbox id="allDay" value="#{office.scheduleControler.event.allDay}" />
							<p:commandButton type="reset" value="Reset" />
							<p:commandButton value="Create Visit" actionListener="#{office.scheduleControler.addEvent}" 
											 process="@this, title, from, to, patient" update="scheduler, latestActivities" oncomplete="createDialog.hide();" />
						</h:panelGrid>
					</p:dialog>
					<p:dialog widgetVar="modifyDialog" header="Event Details">
						<h:panelGrid id="modEventDetails" columns="1">
							<p:commandButton value="Delete" actionListener="#{office.scheduleControler.deleteVisit()}"
											process="@this" update="scheduler" oncomplete="modifyDialog.hide();" />
						</h:panelGrid>
					</p:dialog>
					<p:scrollPanel id="latestActivities"  styleClass="latestActivity" mode="native">
						<p:panel id="pnlLatest" header="Latest Activity" style="width:300px;height:500px">
							<p:dataList value="#{office.scheduleControler.visits}" var="visit" itemType="disc"
								rows="10">
								#{visit.toString()}
							</p:dataList>
						</p:panel>
					</p:scrollPanel>
</html>