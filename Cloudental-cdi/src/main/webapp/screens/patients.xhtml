<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:h="http://java.sun.com/jsf/html" 
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">

	<p:panel header="New Patient" >
		<h:panelGrid id="grid" columns="2">
			<h:outputText value="Name: " />
			<p:inputText id="name" value="#{office.patientManagment.createPatient.name}" required="true" requiredMessage="Name is required"  />
			<h:outputText value="Surname: " />
			<p:inputText id="surname" value="#{office.patientManagment.createPatient.surname}" required="true" requiredMessage="Surname is required"/>
			<h:outputText value="Comments: " />
			<p:inputTextarea id="comment" value="#{office.patientManagment.createPatient.comments}" />
			<h:outputText value=" " />
			<p:commandButton value="Create" id="crtBtn" process="@this,name,surname,comment" update="patientList" 
						 actionListener="#{office.patientManagment.createPatient}" />
		</h:panelGrid>
	</p:panel>

 	<p:contextMenu for="patientList">  
        <p:menuitem value="Details" icon="ui-icon-check" process="patientList" oncomplete="dtlDlg.show()" update="detailsDialog"/>
        <p:menuitem value="Delete" icon="ui-icon-close" process="@this,patientList" 
        			actionListener="#{office.patientManagment.deletePatient}" update="patientList,scheduler"/>
    </p:contextMenu>  
    
    <p:dialog id="detailsDialog" header="Patient Details" widgetVar="dtlDlg" height="140" >
    	<p:panelGrid columns="1">
		    <h:outputLabel id="dtlSurname" value="#{office.patientManagment.selectedPatient.surname}" />
		    <h:outputLabel id="dtlName" value="#{office.patientManagment.selectedPatient.name}" />
		    <h:outputLabel id="dtlCreated" value="#{office.patientManagment.selectedPatient.created}" />
		    <h:outputLabel id="dtlComments" value="#{office.patientManagment.selectedPatient.comments}" />
    	</p:panelGrid>
    </p:dialog>
	<p:dataTable id="patientList" var="patient" value="#{office.patientManagment.patientList}"    
		rowKey="#{patient.id}"  selection="#{office.patientManagment.selectedPatient}" selectionMode="single">
		<p:column headerText="Surname" sortBy="#{patient.surname}" width="200">
			#{patient.surname}  
		</p:column>
		<p:column headerText="Name" sortBy="#{patient.name}" width="200">
			#{patient.name}  
		</p:column>
		<p:column headerText="Created" sortBy="#{patient.created}" width="200">
			#{patient.created}  
		</p:column>
		
	</p:dataTable>
</html>
